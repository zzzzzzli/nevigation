

捷联式惯性导航原理
===

# 基本概念
## 惯性导航的基本原理
### 导航的基本概念
- **导航** 就是正确引导 **航行体** 沿着 **预定轨道** **在规定时间内** 到达目的地
- **导航系统** 只提供 **导航参数（任意时刻航行体的地理位置、航行速度、航行体的姿态、航向等）**，不直接参与对导航体的控制。导航系统是一个开环系统，也是一个信息处理系统，即把导航仪表测得的航行信息处理成各种需要的导航参数。**导航系统 + 自动驾驶系统** 才是一个完整的闭环系统，称为 **导航自动控制系统**
![导航闭环系统](ncls.PNG)

### 惯性导航的工作原理
- **惯性导航** 是一种自主式的导航方法，完全依靠机载设备自主地完成导航任务，不与外界发生光、电等联系，隐蔽性好，不受气象条件限制，用于军事领域（导弹、舰船、飞机、宇宙航行器）。

- 惯性导航的工作原理基于 **牛顿力学**，航行体内用导航加速度表测量飞行器的加速度，并以此积分求得导航器的速度、位置。飞行器的瞬时位置由坐标 $x,y$ 来表示，在飞行器内用一个导航平台把两个导航加速度计的测量轴分别固定在 $x$ 和 $y$ 方向，则飞行器的瞬时速度和瞬时位置可由下式求得：
  $$
  v_x(t)=v_x(0)+\int_0^t a_x{\rm d}{\tau}\\
  v_y(t)=v_y(0)+\int_0^t a_y{\rm d}{\tau}\\
  x(t)=x(0)+\int_0^t v_x{\rm d}{\tau}\\
  y(t)=y(0)+\int_0^t v_y{\rm d}{\tau}
  $$
  其中 $a_x, a_y$ 由两个加速度计测得。

- 实际的惯性导航中，用经纬度 $\lambda$ 和 $\varphi$ 来表示飞行器的地理位置，如果 $x$ 指向北，$y$ 指向东，则经纬度表示为：
  $$
  \varphi(t)=\varphi_0+\frac1R\int_0^tv_x{\rm d}\tau\\
  \lambda(t)=\lambda_0+\frac1{R\cos\varphi(t)}\int_0^tv_y{\rm d}\tau
  $$
   其中 $R$ 为地球半径。

- 导航加速度计的测量范围为 $10^{-6}g$ 到 $10^{-9}g$, 分辨率要 $10^{-6}g$, 陀螺漂移要在 $0.01$度/小时 到 $0.001$度/小时，导航平台的水平精度要在 $10$ 到 $20$ 角秒。
### 导航中常用的坐标系
- **地心惯性坐标系（$i$ 系，$x_i,y_i,z_i$ 轴）**，原点在地球中心，$z_i$ 轴沿地球自转方向，$x_i,y_i$ 轴在赤道平面内，指向恒星方向，$x_i,y_i,z_i$ 形成右手坐标系，并且固定不动。该坐标系是惯性仪表测量的参考标准。
- **地球坐标系（$e$ 系，$x_e,y_e,z_e$ 坐标轴）**，原点在地球中心，$z_e$ 轴与地球自转轴重合，$x_e$ 轴在赤道平面内指向格林威治子午线，$y_e$ 轴在赤道平面内，$x_e,y_e,z_e$ 形成右手坐标系。该坐标系与地球固连，相对于地心惯性坐标系的运动就是地球的自转速度 $\omega$。
- **地理坐标系（$n$ 系，NED 坐标轴）**，原点在飞行器中心，N 轴指北，E 轴指东，D 轴和重力 $g$ 方向一致，也叫 **北东地坐标系**，地理坐标系也可以取 **东北天**、**北西天**坐标系。
- **机体坐标系（$b$ 系，$x_b,y_b,z_b$ 坐标轴）**，与飞行器固连，原点在飞行器中心，$x_b$ 轴沿飞行器纵轴方向，$y_b$ 轴和飞行器的横轴方向一致，$z_b$ 轴沿飞行器竖轴向下，$x_b,y_b,z_b$ 轴形成右手坐标系。机体坐标系相对于地理坐标系的方位为飞行器的姿态和航向。
![坐标系](cs.PNG)
## 飞行器的位置、姿态、航向的确定
- 导航参数：
  - 飞行器瞬时地理位置、瞬时速度
  - 飞行器的姿态，航向
  - 偏流角
  - 已飞距离、待飞距离
  - 航迹角
  - $\cdots$
- **当用经纬度表示飞行器地理位置时，地理位置就是地理坐标系（n 系）和地球坐标系之间的方位关系**
从地球坐标系（$e$ 系）到地理坐标系（$n$ 系的变换矩阵位）：
$$
\begin{pmatrix}
N \\
E \\
D
\end{pmatrix}
=
C_e^n
\begin{pmatrix}
x_e \\
y_e \\
z_e
\end{pmatrix}
$$
其中 **变换矩阵（也叫位置矩阵）** $C_e^n$ 为
$$
\begin{pmatrix}
c_{11} & c_{12} & c_{13} \\
c_{21} & c_{22} & c_{23} \\
c_{31} & c_{32} & c_{33}
\end{pmatrix}
=
\begin{pmatrix}
-\sin\varphi\cos\lambda & -\sin\varphi\sin\lambda & \cos\varphi \\
-\sin\lambda & \cos\lambda & 0 \\
-\cos\varphi\cos\lambda & -\cos\varphi\sin\lambda & -\sin\varphi
\end{pmatrix}
$$
其中 $\lambda$ 和 $\varphi$ 即为飞行器的地理坐标（**经纬度**）。该变换包含了一个 $x_e,y_e$ 平面内绕 $z_e$ 轴 $\lambda$ 角度的转动得到 $x'_e,y'_e,z'_e$，和绕 $y'_e$ 轴 $90^{\circ}+\varphi$ 的转动。（**注意：两步转动操作并不能完全得到$n$系，因为两坐标系的原点不重合，需要一个平移，但是仅靠转动操作足以求出$\lambda$ 和 $\varphi$**）
在飞行器飞行的过程中，如果能实时地知道 $c_{ij}$，则可由下式实时地知道飞行器的地理坐标：
$$
\varphi=-\sin^{-1}c_{33}\\
\lambda=\tan^{-1}\frac{c_{32}}{c_{31}}
$$
惯性导航就是在飞行器飞行过程中实时计算 $C_e^n$ 中的各个元素。

- **飞行器的姿态和航向就是机体坐标系（$b$ 系）和地理坐标系（$n$ 系）之间的方位关系**
    - **航向角：** 飞行器 $x_b$ 轴与地理北向的夹角($\psi\in[0^\circ,360^\circ)$)，描述飞行器绕 $D$ 轴的转动；![](b1.PNG)

      ![](b2.PNG)

    - **俯仰角：** 飞行器 $x_b$ 轴与水平面（或纵向水平轴）的夹角($\theta\in[-90^\circ,90^\circ]$)，描述飞行器绕横向水平轴 $E$ 的转动，向上为正，向下为负；

      ![](b3.PNG)

    - **倾斜角：** 飞行器纵向对称平面（$x_b,z_b$轴构成的平面）与纵向铅锤平面（$x_b,D$轴构成的平面）的夹角($\gamma\in[-180^\circ,180^\circ]$)，描述飞行器绕 $x_b$ 轴的转动，右倾为正，左倾为负。

      ![](b4.PNG)

- 变换矩阵 $C_n^b$ 为：
$$
\begin{pmatrix}
\cos\psi\cos\theta & \sin\psi\cos\theta & -\sin\theta \\
\cos\psi\sin\theta\sin\gamma-\sin\psi\cos\gamma & \sin\psi\sin\theta\sin\gamma+\cos\psi\cos\gamma & \cos\theta\sin\gamma \\
\cos\psi\sin\theta\cos\gamma+\sin\psi\sin\gamma & \sin\psi\sin\theta\cos\gamma-\cos\psi\sin\gamma &
\cos\theta\cos\gamma
\end{pmatrix}=(T_{ij})
$$
- 如果知道了变换矩阵 $C_n^b$ （也叫 **姿态矩阵**） 的各个元素，就可以通过下式得到飞行器的姿态和航向角：
$$
\psi=\tan^{-1}\frac{T_{12}}{T_{11}}\\
\theta=-\sin^{-1}T_{13}\\
\gamma=\tan^{-1}\frac{T_{23}}{T_{33}}
$$
- 在平台式惯性导航系统中，地理坐标系和是可以由平台实验体模拟的，即可以由几何关系测得姿态角和航向角，并不需要实时计算，但是在捷联式惯性导航系统中，由于没有实验平台，必须实时计算姿态矩阵，并从中获取飞行器姿态和航向信息，这是一个难题（飞行器姿态变化速率太快）。

## 捷联式惯导和平台式惯导的主要区别
捷联式和平台式惯导的主要区别是前者采用数字导航平台，用以计算姿态矩阵和其他导航参数，加速度计和陀螺仪安装在飞行器机体上，后者采用平台导航系统，直接测量姿态角和航向角。
# 捷联式惯导的基本算法
## 捷联式惯导算法概述
捷联式惯性导航系统是一个信息处理系统，就是把机体安装的惯性仪表所测量的飞行器运动信息，经过计算机处理成所需要的导航和控制信息。所谓“捷联式惯性导航算法”就是指 **从惯性仪表的输出到给出需要的导航和控制信息所必须进行的全部计算问题的计算方法。** 计算 的内容和要求，根据应用和功能的不同有很大的差别，一般来说，捷联式惯导的基本算法有如下内容：
- **系统的启动和自检测：** 系统启动后，各个部分是否工作正常，要通过自检程序检测，其中包括电源、惯性仪表、计算机及计算机软件。通过自检测，发现有不正常，则发出警告。
- **系统的初始化：** 包括三项内容：
    - 给定飞行器的初始位置和初始速度等信息；
    - 导航平台的初始对准，在平台式惯导中，初始对准就是平台坐标系和导航坐标系相一致，是用物理方法来实现的，但是在捷联式惯导中，初始对准则是姿态矩阵的初始值，是用计算机程序来完成的；
    - 惯性仪表的校准，对陀螺仪的标度系数进行测定，对陀螺仪的漂移进行测定和补偿，对加速度计也进行同样的标度系数测定并存入计算机；
- **惯性仪表的误差补偿。**
- **姿态矩阵的计算。**
- **导航计算**，即把加速度计的输出信息变换到导航坐标系，并计算飞行器的导航信息。
- **制导和控制信息的提取。**
![](导航算法流程图.PNG)

## 姿态矩阵的计算

确定两坐标系方位关系的问题，即刚体定点转动理论：**三参数法（欧拉角法）、四参数法、九参数法。**
- **欧拉角法：**
    - 欧拉角表示姿态矩阵 
    - 欧拉角微分方程

- **方向余弦法：**
    - 方向余弦表示姿态矩阵
    - 方向余弦微分方程
    - 矢量转动坐标变换
    - 矩阵微分方程的解

- **四元数法：**

    - 四元数的基本概念

    - 矢量坐标变换的四元数表示
      $$
      \vec r'=Q\circ r Q^*\\
      \vec r=Q\circ r' Q
      $$

    - 四元数和方向余弦的关系，即
      $$
      Q(R_b)=M(Q^*)M^*(Q)\bar{Q}(R_n)\\
      $$
      其中，
      $$
      Q(R_b)=[0,x_b,y_b,z_b]^T\\
      Q(R_n)=[0,x_n,b_n,z_n]^T\\
      M(Q^*)=
      \begin{pmatrix}
          q_0 & q_1 & q_2 & q_3 \\
          -q_1 & q_0 & q_3 & -q_2 \\
          -q_2 & -q_3 & q_0 & q_1\\
          -q_3 & q_2 & -q_1 & q_0\\
       \end{pmatrix}
      $$
      如果知道了四元数的四个元素，就可以知道姿态矩阵的九个元素。

    - 四元数微分方程

    - 四元数微分方程的解

- **等效转动矢量法**

    - 转动的不可交换性
    - 等效转动矢量微分方程

这四种方法都可以用来确定运动坐标系相对于参考坐标系的方位关系，在捷联式惯导中，既可以用来算姿态矩阵，也可以用来算位置矩阵，在实际中由于姿态矩阵的实时计算速度要快，一般采用四元数法，而位置矩阵的计算速度要慢，一般采用方向余弦法。

## 姿态矩阵计算机上的执行算法

### 增量算法

- 陀螺仪：	陀螺仪是一种 **用高速回转体的动量矩敏感壳体相对惯性空间绕正交于自转轴的一或二个轴的角运动检测装置** 用来测量角位移的器件。捷联式陀螺仪，都是采用脉冲再平衡回路，其输出是一串脉冲，每一个脉冲代表一个叫增量$\Delta\theta=\int_t^{t+\Delta t}\omega_{ib}(\tau)\rm{d}\tau$。利用该角增量直接计算姿态矩阵或姿态四元数，则叫做增量算法。增量算法一般有 **定时增量算法** 和 **固定增量算法** 两种。
- 定时增量算法：在规定的时间采样区间对陀螺仪的输出进行采样，不管角增量的大小。
- 固定增量算法：对陀螺仪输出按一定大小增量进行采样，每个陀螺仪输出到达一定增量时即被送入计算机。

### 数值积分法

用数字计算机求解微分方程的数值积分

- 一阶龙格库塔算法（Runge-Kutta）
- 二阶龙格库塔算法
- 四阶龙格库塔算法

### 姿态航向信息和角速度信息的提取

#### 姿态和航向信息的提取

#### 加速度信息提取

- 一阶（角速度视为常数）角速度提取
- 二解（角速度视为线性）角速度提取（采用四阶龙格库塔算法积分时常用）

## 捷联式惯导系统的程序编排

捷联式惯导系统中所使用的陀螺仪分为两种：一是速率陀螺仪，用来测量飞行器角速度；二是位置陀螺仪，用来测量角位置

### 用惯性坐标系的捷联式惯导系统

- 变换矩阵的计算，$C_b^i$，解四元数微分方程得到
  $$
  Q(\dot q)=\frac12M^*(\omega_b)Q(q)
  $$

- 惯性坐标系中的加速度，加速度计的输出正比于飞行器的惯性加速度与地心引力加速度之差
  $$
  \ddot R^i=C_b^if^b+G_i
  $$
  式中，$\ddot R$ 为计算的惯性加速度，$R^i$ 飞行器在惯性坐标系中的位置矢量，$G_i$ 计算的地球引力加速度

- 引力加速度的计算

- 速度的计算：飞行器相对于地球坐标系位置矢量的时间变化率 $V^e=\dot {R^e}$，地理坐标系中
  $$
  V^n=[V_N,V_E,V_D]^T=C_i^n(\dot R^i-\omega_{je}^{ik})
  $$

- 位置计算

  - 地理纬度 $\varphi$ 和地心纬度 $\varphi_c$ 的关系：
    $$
    \varphi=\varphi_c+D\\
    \varphi_D=\sin^{-1}\frac{\hat T_z}{\hat R}\\
    D\approx e\sin2\varphi \quad\text{垂线偏差}\\
    e=\frac{R_e-R_p}{R_e} \quad\text{地球椭圆度}\\
    R_p \quad\text{地球极轴半径}\\
    \hat\varphi=\sin^{-1}\frac{\hat T_z}{\hat R}+e\sin2\hat\varphi
    $$

- 姿态和航向的计算

### 用地理坐标系的捷联式惯导系统

- 姿态矩阵的计算
- 速度计算
- 重力计算
- 经纬度和高度的计算
- 垂直通道的阻尼

### 用游动方位坐标系的捷联式惯导系统

游动方位坐标系：将 $n$ 系绕 $D$ 轴 旋转 $\alpha$ 角度得到，并以 $\omega_{ie}\sin\varphi$ 的角速度绕 $z_e$ 轴转动

- 导航位置计算

  - 位置矩阵的计算，由于游动方位坐标系相对于地球的运动角速度较小，因此一般采用解矩阵微分方程的方法求解位置矩阵
    $$
    \dot C_p^e=C_p^e\omega_{eP}^{pK}
    $$
    其中，
    $$
    \omega_{eP}^{pK}=
    \begin{pmatrix}
    0 & -\omega_{epz} & \omega_{epy}\\
    \omega_{epz} & 0 & -\omega_{epx}\\
    -\omega_{epy} & \omega_{epx} & 0
    \end{pmatrix}
    $$
    其中 $\omega_{epz}=0$.

  - 经纬度和游动角的计算

- 速度计算

- 姿态和航向角的计算

- 垂直通道的三阶阻尼回路

### 用静电陀螺仪的捷联式惯导系统

经典陀螺仪可以直接测量机体坐标系相对于惯性坐标系的角位置

![](静电陀螺仪飞行器.PNG)

两个经典陀螺仪和三个加速度计固连在飞行器上

## 捷联惯导的误差分析

误差来源：

1. 惯性仪表的安装误差和标度因子误差；
2. 陀螺仪的漂移误差和加速度计的零位误差；
3. 初始条件误差，包括导航参数和姿态航向的初始误差；
4. 计算误差，主要考虑姿态航向系统的计算误差，也就是数学平台的计算误差；
5. 飞行器的叫运动引起的陀螺仪的动态误差

### 加速度仪表和陀螺仪的安装误差和标度误差

#### 非正交变换

一个正交坐标系 $p$ 和一个非正交坐标系（各个轴不是完全正交的，有一个误差角）$a$ 之间的变换，在误差角很小的情况下，从 $p$ 到 $a$ 的变换可以写成
$$
p\to a:\quad f^a=[I+(\Delta C_a^p)^T]f^p
$$
即 $C_a^p=I+\Delta C_a^p$，其中 $\Delta C_a^p$ 代表了误差角，那么从 $a$ 到 $p$ 的变换不是 $f^p=C_a^pf^a$，而是
$$
a\to p:\quad f^p=[I-(\Delta C_a^p)^T]f^a
$$
即${C^*}_a^p=I-(\Delta C^p_a)^T$

#### 安装误差

捷联式惯导的三个加速度仪和三个（或者两个）陀螺仪是直接安装在飞行器上，按照要求，惯性器件的三个输入轴应该和机体坐标系的三个轴完全一致，但实际上，在安装时总存在这误差。每个加速度计和陀螺仪输入轴的安装误差可以用两个参数来描述，此时，加速度计坐标系和陀螺仪坐标系都变成了非正交坐标系，此时加速度计和陀螺仪的变换公式为
$$
f^b=[I-(\Delta C_a^b)^T]\widetilde f^a\\
\omega^b_{i,b}=[I-(\Delta C_g^b)^T]\widetilde\omega_{i,b}^g
$$
即可消除安装误差。然而，$(\Delta C_a^b)^T$ 和 $(\Delta C_g^b)^T$ 表示加速度计和陀螺仪的安装误差角，这是做不到的。

#### 标度误差

标度因子和标度误差：加速度计和陀螺仪的输出是脉冲，每一个脉冲信号代表一个速度增量（或者角度增量），用 $q_a$ 和 $q_g$ 表示，即标度因子，$q_a$ 和 $q_g$ 分别是加速度计的标度因子和陀螺仪的标度因子。标度因子通过测定，存入计算机内，每次采样后，将得到的脉冲数乘以标度因子，就是要得到的增量。实际工作中测得的标度因子很可能和计算机中的不一致，即存在标度误差。

用 $q_{ac}$ 和 $q_{gc}$ 表示计算机存储的标度因子，有如下关系：
$$
\bold q_{ac}=q_a(I+K_a)\\
\bold q_{gc}=q_g(I+K_g)
$$
其中
$$
K_a=
\begin{pmatrix}
k_{ax} & 0 & 0 \\
0 & k_{ay} & 0 \\
0 & 0 & k_{az}
\end{pmatrix}\quad
K_g=
\begin{pmatrix}
k_{gx} & 0 & 0 \\
0 & k_{gy} & 0 \\
0 & 0 & k_{gz}
\end{pmatrix}
$$
分别表示三个加速度计（陀螺仪）的标度因子误差形成的对角矩阵。