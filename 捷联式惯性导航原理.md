捷联式惯性导航原理
===

# 基本概念
## 惯性导航的基本原理
### 导航的基本概念
- **导航** 就是正确引导 **航行体** 沿着 **预定轨道** **在规定时间内** 到达目的地
- **导航系统** 只提供 **导航参数（任意时刻航行体的地理位置、航行速度、航行体的姿态、航向等）**，不直接参与对导航体的控制。导航系统是一个开环系统，也是一个信息处理系统，即把导航仪表测得的航行信息处理成各种需要的导航参数。**导航系统 + 自动驾驶系统** 才是一个完整的闭环系统，称为 **导航自动控制系统**
![导航闭环系统](ncls.PNG)

### 惯性导航的工作原理
- **惯性导航** 是一种自主式的导航方法，完全依靠机载设备自主地完成导航任务，不与外界发生光、电等联系，隐蔽性好，不受气象条件限制，用于军事领域（导弹、舰船、飞机、宇宙航行器）。
- 惯性导航的工作原理基于 **牛顿力学**，航行体内用导航加速度表测量飞行器的加速度，并以此积分求得导航器的速度、位置。飞行器的瞬时位置由坐标 $x,y$ 来表示，在飞行器内用一个导航平台把两个导航加速度计的测量轴分别固定在 $x$ 和 $y$ 方向，则飞行器的瞬时速度和瞬时位置可由下式求得：$$v_x(t)=v_x(0)+\int_0^t a_x{\rm d}{\tau}$$ $$v_y(t)=v_y(0)+\int_0^t a_y{\rm d}{\tau}$$ $$x(t)=x(0)+\int_0^t v_x{\rm d}{\tau}$$ $$y(t)=y(0)+\int_0^t v_y{\rm d}{\tau}$$
其中 $a_x, a_y$ 由两个加速度计测得。
- 实际的惯性导航中，用经纬度 $\lambda$ 和 $\varphi$ 来表示飞行器的地理位置，如果 $x$ 指向北，$y$ 指向东，则经纬度表示为：$$\varphi(t)=\varphi_0+\frac1R\int_0^tv_x{\rm d}\tau$$ $$\lambda(t)=\lambda_0+\frac1{R\cos\varphi(t)}\int_0^tv_y{\rm d}\tau$$ 其中 $R$ 为地球半径。
- 导航加速度计的测量范围为 $10^{-6}g$ 到 $10^{-9}g$, 分辨率要 $10^{-6}g$, 陀螺漂移要在 $0.01$度/小时 到 $0.001$度/小时，导航平台的水平精度要在 $10$ 到 $20$ 角秒。
### 导航中常用的坐标系
- **地心惯性坐标系（$i$ 系，$x_i,y_i,z_i$ 轴）**，原点在地球中心，$z_i$ 轴沿地球自转方向，$x_i,y_i$ 轴在赤道平面内，指向恒星方向，$x_i,y_i,z_i$ 形成右手坐标系，并且固定不动。该坐标系是惯性仪表测量的参考标准。
- **地球坐标系（$e$ 系，$x_e,y_e,z_e$ 坐标轴）**，原点在地球中心，$z_e$ 轴与地球自转轴重合，$x_e$ 轴在赤道平面内指向格林威治子午线，$y_e$ 轴在赤道平面内，$x_e,y_e,z_e$ 形成右手坐标系。该坐标系与地球固连，相对于地心惯性坐标系的运动就是地球的自转速度 $\omega$。
- **地理坐标系（n 系，NED 坐标轴）**，原点在飞行器中心，N 轴指北，E 轴指东，D 轴和重力 $g$ 方向一致，也叫 **北东地坐标系**，地理坐标系也可以取 **东北天**、**北西天**坐标系。
- **机体坐标系（$b$ 系，$x_b,y_b,z_b$ 坐标轴）**，与飞行器固连，原点在飞行器中心，$x_b$ 轴沿飞行器纵轴方向，$y_b$ 轴和飞行器的横轴方向一致，$z_b$ 轴沿飞行器竖轴向下，$x_b,y_b,z_b$ 轴形成右手坐标系。机体坐标系相对于地理坐标系的方位为飞行器的姿态和航向。
![坐标系](cs.PNG)
## 飞行器的位置、姿态、航向的确定
- 导航参数：
  - 飞行器瞬时地理位置、瞬时速度
  - 飞行器的姿态，航向
  - 偏流角
  - 已飞距离、待飞距离
  - 航迹角
  - $\cdots$
- **当用经纬度表示飞行器地理位置时，地理位置就是地理坐标系（n 系）和地球坐标系之间的方位关系**
从地球坐标系（$e$ 系）到地理坐标系（$n$ 系的变换矩阵位）：
$$
\begin{pmatrix}
N \\
E \\
D
\end{pmatrix}
=
C_e^n
\begin{pmatrix}
x_e \\
y_e \\
z_e
\end{pmatrix}
$$
其中 **变换矩阵（也叫位置矩阵）** $C_e^n$ 为
$$
\begin{pmatrix}
c_{11} & c_{12} & c_{13} \\
c_{21} & c_{22} & c_{23} \\
c_{31} & c_{32} & c_{33}
\end{pmatrix}
=
\begin{pmatrix}
-\sin\varphi\cos\lambda & -\sin\varphi\sin\lambda & \cos\varphi \\
-\sin\lambda & \cos\lambda & 0 \\
-\cos\varphi\cos\lambda & -\cos\varphi\sin\lambda & -\sin\varphi
\end{pmatrix}
$$
其中 $\lambda$ 和 $\varphi$ 即为飞行器的地理坐标（**经纬度**）。该变换包含了一个 $x_e,y_e$ 平面内绕 $z_e$ 轴 $\lambda$ 角度的转动得到 $x'_e,y'_e,z'_e$，和绕 $y'_e$ 轴 $90^{\circ}+\varphi$ 的转动。（**注意：两步转动操作并不能完全得到$n$系，因为两坐标系的原点不重合，需要一个平移，但是仅靠转动操作足以求出$\lambda$ 和 $\varphi$**）
在飞行器飞行的过程中，如果能实时地知道 $c_{ij}$，则可由下式实时地知道飞行器的地理坐标：
$$\varphi=-\sin^{-1}c_{33}$$ $$\lambda=\tan^{-1}\frac{c_{32}}{c_{31}}$$
惯性导航就是在飞行器飞行过程中实时计算 $C_e^n$ 中的各个元素。

- **飞行器的姿态和航向就是机体坐标系（$b$ 系）和地理坐标系（$n$ 系）之间的方位关系**
    - **航向角：** 飞行器 $x_b$ 轴与地理北向的夹角($\psi\in[0^\circ,360^\circ)$)，描述飞行器绕 $D$ 轴的转动；![](b1.PNG)![](b2.PNG)
    - **俯仰角：** 飞行器 $x_b$ 轴与水平面（或纵向水平轴）的夹角($\theta\in[-90^\circ,90^\circ]$)，描述飞行器绕横向水平轴 $E$ 的转动，向上为正，向下为负；![](b3.PNG)
    - **倾斜角：** 飞行器纵向对称平面（$x_b,z_b$轴构成的平面）与纵向铅锤平面（$x_b,D$轴构成的平面）的夹角($\gamma\in[-180^\circ,180^\circ]$)，描述飞行器绕 $x_b$ 轴的转动，右倾为正，左倾为负。![](b4.PNG)
- 变换矩阵 $C_n^b$ 为：
$$
\begin{pmatrix}
\cos\psi\cos\theta & \sin\psi\cos\theta & -\sin\theta \\
\cos\psi\sin\theta\sin\gamma-\sin\psi\cos\gamma & \sin\psi\sin\theta\sin\gamma+\cos\psi\cos\gamma & \cos\theta\sin\gamma \\
\cos\psi\sin\theta\cos\gamma+\sin\psi\sin\gamma & \sin\psi\sin\theta\cos\gamma-\cos\psi\sin\gamma &
\cos\theta\cos\gamma
\end{pmatrix}=(T_{ij})
$$
- 如果知道了变换矩阵 $C_n^b$ （也叫 **姿态矩阵**） 的各个元素，就可以通过下式得到飞行器的姿态和航向角：
$$
\psi=\tan^{-1}\frac{T_{12}}{T_{11}}\\
\theta=-\sin^{-1}T_{13}\\
\gamma=\tan^{-1}\frac{T_{23}}{T_{33}}
$$
- 在平台式惯性导航系统中，地理坐标系和是可以由平台实验体模拟的，即可以由几何关系测得姿态角和航向角，并不需要实时计算，但是在捷联式惯性导航系统中，由于没有实验平台，必须实时计算姿态矩阵，并从中获取飞行器姿态和航向信息，这是一个难题（飞行器姿态变化速率太快）。

## 捷联式惯导和平台式惯导的主要区别
捷联式和平台式惯导的主要区别是前者采用数字导航平台，用以计算姿态矩阵和其他导航参数，加速度计和陀螺仪安装在飞行器机体上，后者采用平台导航系统，直接测量姿态角和航向角。
# 捷联式惯导的基本算法
## 捷联式惯导算法概述
捷联式惯性导航系统是一个信息处理系统，就是把机体安装的惯性仪表所测量的飞行器运动信息，经过计算机处理成所需要的导航和控制信息。所谓“捷联式惯性导航算法”就是指 **从惯性仪表的输出到给出需要的导航和控制信息所必须进行的全部计算问题的计算方法。** 计算 的内容和要求，根据应用和功能的不同有很大的差别，一般来说，捷联式惯导的基本算法有如下内容：
- **系统的启动和自检测：** 系统启动后，各个部分是否工作正常，要通过自检程序检测，其中包括电源、惯性仪表、计算机及计算机软件。通过自检测，发现有不正常，则发出警告。
- **系统的初始化：** 包括三项内容：
    - 给定飞行器的初始位置和初始速度等信息；
    - 导航平台的初始对准，在平台式惯导中，初始对准就是平台坐标系和导航坐标系相一致，是用物理方法来实现的，但是在捷联式惯导中，初始对准则是姿态矩阵的初始值，是用计算机程序来完成的；
    - 惯性仪表的校准，对陀螺仪的标度系数进行测定，对陀螺仪的漂移进行测定和补偿，对加速度计也进行同样的标度系数测定并存入计算机；
- **惯性仪表的误差补偿。**
- **姿态矩阵的计算。**
- **导航计算**，即把加速度计的输出信息变换到导航坐标系，并计算飞行器的导航信息。
- **制导和控制信息的提取。**
![](导航算法流程图.PNG)

## 姿态矩阵的计算
确定两坐标系方位关系的问题，即刚体定点转动理论：**三参数法（欧拉角法）、四参数法、九参数法。**
- **欧拉角法：**